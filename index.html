<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calculadora Pro - Precios Freelancer</title>

  <!-- Monetag: conserva la meta (identificador) en head -->
  <meta name="monetag" content="3be5e844567977a9ec817c345620663e">

  <!-- Meta para robots / seguridad m√≠nima -->
  <meta name="theme-color" content="#667eea" />

  <style>
    /* --- (estilos condensados - incluye todo lo necesario, iguales que en la versi√≥n corregida) --- */
    body { box-sizing: border-box; margin:0; padding:0; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg,#667eea 0%,#764ba2 100%); min-height:100vh; color:#333; }
    .container{max-width:800px;margin:0 auto;padding:20px;}
    .header{text-align:center;color:white;margin-bottom:30px;}
    .header h1{font-size:2.5rem;margin-bottom:10px;text-shadow:2px 2px 4px rgba(0,0,0,.3);}
    .header p{font-size:1.1rem;opacity:.95;}
    .calculator-card{background:white;border-radius:20px;padding:30px;box-shadow:0 20px 40px rgba(0,0,0,.1);margin-bottom:20px;}
    .form-group{margin-bottom:20px;}
    .form-group label{display:block;font-weight:600;margin-bottom:8px;color:#555;}
    .form-group input,.form-group select{width:100%;padding:12px;border:2px solid #e1e5e9;border-radius:10px;font-size:1rem;box-sizing:border-box;}
    .form-row{display:grid;grid-template-columns:1fr 1fr;gap:16px;}
    .calculate-btn{width:100%;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;border:none;padding:16px;border-radius:12px;font-size:1.1rem;font-weight:700;cursor:pointer;text-transform:uppercase;}
    .results{background:linear-gradient(135deg,#11998e 0%,#38ef7d 100%);color:#fff;border-radius:12px;padding:20px;margin-top:16px;display:none;}
    .results.show{display:block;}
    .result-item{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid rgba(255,255,255,.15);}
    .result-item:last-child{border-bottom:none;font-weight:700;padding:12px;border-radius:8px;background:rgba(255,255,255,.06);}
    .premium-features{background:linear-gradient(135deg,#ffecd2 0%,#fcb69f 100%);border-radius:12px;padding:18px;margin-top:16px;text-align:center;}
    .premium-btn{background:#ff6b6b;color:#fff;border:none;padding:10px 20px;border-radius:20px;cursor:pointer;font-weight:700;}
    .ad-banner{background:#f8f9fa;border:2px dashed #ddd;border-radius:10px;padding:18px;text-align:center;margin:20px 0;min-height:80px;display:flex;align-items:center;justify-content:center;}
    .tips{background:#f8f9fa;border-radius:12px;padding:16px;margin-top:16px;}
    .tip-item{background:#fff;padding:12px;border-radius:8px;margin-bottom:8px;border-left:4px solid #667eea;}
    .chat-assistant{position:fixed;bottom:20px;right:20px;z-index:1000;}
    .chat-toggle{width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);border:none;color:#fff;font-size:20px;cursor:pointer;box-shadow:0 4px 20px rgba(0,0,0,.15);}
    .chat-window{position:absolute;bottom:80px;right:0;width:350px;height:500px;background:#fff;border-radius:12px;box-shadow:0 10px 40px rgba(0,0,0,.2);display:none;flex-direction:column;overflow:hidden;}
    .chat-window.show{display:flex;}
    .chat-header{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;padding:12px 16px;display:flex;justify-content:space-between;align-items:center;}
    .chat-messages{flex:1;padding:14px;overflow-y:auto;background:#f8f9fa;}
    .message{margin-bottom:12px;padding:10px 12px;border-radius:12px;max-width:80%;}
    .message.bot{background:#e3f2fd;color:#1565c0;align-self:flex-start;}
    .message.user{background:#667eea;color:#fff;align-self:flex-end;margin-left:auto;}
    .chat-input{padding:12px;border-top:1px solid #eee;display:flex;gap:8px;}
    .chat-input input{flex:1;padding:8px 12px;border-radius:20px;border:1px solid #ddd;}
    .cookie-banner{position:fixed;left:16px;right:16px;bottom:16px;background:rgba(0,0,0,.88);color:#fff;padding:12px 16px;border-radius:12px;display:flex;gap:12px;align-items:center;z-index:2000;}
    .cookie-banner button{background:#38ef7d;border:none;padding:8px 12px;border-radius:8px;cursor:pointer;}
    @media(max-width:768px){.form-row{grid-template-columns:1fr}.chat-window{width:300px;height:400px}.header h1{font-size:1.8rem}}
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üí∞ Calculadora Pro Freelancer</h1>
      <p>Calcula precios profesionales y maximiza tus ganancias</p>
    </div>

    <!-- Banner superior (placeholder; Monetag mostrar√° anuncios una vez que cargue su script) -->
    <div class="ad-banner"><div id="monetag-banner-top">(Hello, Monetag)</div></div>

    <div class="calculator-card">
      <form id="priceCalculator" novalidate>
        <div class="form-group">
          <label for="serviceType">üéØ Tipo de Servicio</label>
          <select id="serviceType" required>
            <option value="">Selecciona tu servicio</option>
            <option value="web-design">Dise√±o Web</option>
            <option value="graphic-design">Dise√±o Gr√°fico</option>
            <option value="programming">Programaci√≥n</option>
            <option value="marketing">Marketing Digital</option>
            <option value="writing">Redacci√≥n</option>
            <option value="photography">Fotograf√≠a</option>
            <option value="consulting">Consultor√≠a</option>
            <option value="video">Edici√≥n de Video</option>
          </select>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="hourlyRate">üíµ Tarifa por Hora ($)</label>
            <input type="number" id="hourlyRate" min="0" step="0.01" required placeholder="25.00">
          </div>
          <div class="form-group">
            <label for="estimatedHours">‚è∞ Horas Estimadas</label>
            <input type="number" id="estimatedHours" min="0" step="0.5" required placeholder="40">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="expenses">üìä Gastos del Proyecto ($)</label>
            <input type="number" id="expenses" min="0" step="0.01" placeholder="100.00">
          </div>
          <div class="form-group">
            <label for="profitMargin">üìà Margen de Ganancia (%)</label>
            <input type="number" id="profitMargin" min="0" max="100" step="1" value="20">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="taxes">üèõÔ∏è Impuestos (%)</label>
            <input type="number" id="taxes" min="0" max="50" step="0.1" value="15">
          </div>
          <div class="form-group">
            <label for="urgency">‚ö° Urgencia del Proyecto</label>
            <select id="urgency">
              <option value="normal">Normal (0%)</option>
              <option value="urgent">Urgente (+25%)</option>
              <option value="emergency">Emergencia (+50%)</option>
            </select>
          </div>
        </div>

        <button type="submit" class="calculate-btn">üöÄ Calcular Precio Profesional</button>
      </form>

      <div id="results" class="results" aria-live="polite">
        <h3>üìã Desglose de Precios</h3>
        <div class="result-item"><span>Costo Base (Horas √ó Tarifa):</span><span id="baseCost">$0.00</span></div>
        <div class="result-item"><span>Gastos del Proyecto:</span><span id="projectExpenses">$0.00</span></div>
        <div class="result-item"><span>Margen de Ganancia:</span><span id="profitAmount">$0.00</span></div>
        <div class="result-item"><span>Recargo por Urgencia:</span><span id="urgencyFee">$0.00</span></div>
        <div class="result-item"><span>Subtotal:</span><span id="subtotal">$0.00</span></div>
        <div class="result-item"><span>Impuestos:</span><span id="taxAmount">$0.00</span></div>
        <div class="result-item"><span>üí∞ PRECIO FINAL:</span><span id="finalPrice">$0.00</span></div>
      </div>
    </div>

    <div class="premium-features">
      <h3>üåü ¬øQuieres M√°s Funciones?</h3>
      <p>Desbloquea reportes PDF, plantillas de cotizaci√≥n y calculadora de m√∫ltiples proyectos</p>
      <button class="premium-btn" onclick="contactWhatsApp()">Contactar por WhatsApp - Versi√≥n Premium</button>
    </div>

    <div class="ad-banner"><div id="monetag-banner-middle">(Anuncio medio)</div></div>

    <div class="tips">
      <h3>üí° Tips para Maximizar tus Ganancias</h3>
      <div class="tip-item"><strong>üéØ Especial√≠zate:</strong> Los especialistas cobran 2-3x m√°s que los generalistas</div>
      <div class="tip-item"><strong>‚è∞ Cobra por valor:</strong> No solo por tiempo. Considera el impacto en el negocio del cliente</div>
      <div class="tip-item"><strong>üìà Aumenta gradualmente:</strong> Sube tus tarifas 10-15% cada 6 meses</div>
      <div class="tip-item"><strong>üîÑ Proyectos recurrentes:</strong> Ofrece descuentos por contratos a largo plazo</div>
    </div>

    <footer style="text-align:center;margin-top:18px;color:#fff;opacity:.9;">
      <a href="/privacy.html" style="color:inherit;text-decoration:underline;">Pol√≠tica de Privacidad</a>
    </footer>
  </div>

  <!-- Asistente Virtual (chat local simple) -->
  <div class="chat-assistant">
    <button class="chat-toggle" onclick="toggleChat()">üí¨</button>
    <div id="chatWindow" class="chat-window" aria-hidden="true">
      <div class="chat-header">
        <h4>ü§ñ Asistente Freelancer</h4>
        <button class="chat-close" onclick="toggleChat()">√ó</button>
      </div>
      <div class="chat-messages" id="chatMessages">
        <div class="message bot">¬°Hola! üëã Soy tu asistente. Prueba las preguntas r√°pidas o escribe la tuya.</div>
      </div>
      <div class="chat-input">
        <input id="chatInput" type="text" placeholder="Escribe tu pregunta..." onkeypress="handleEnter(event)">
        <button onclick="sendMessage()">üì§</button>
      </div>
    </div>
  </div>

  <!-- Banner de consentimiento para cookies / anuncios -->
  <div id="cookieBanner" class="cookie-banner" style="display:none;">
    <div style="flex:1">Usamos cookies y servicios de terceros (como Monetag) para mostrar anuncios relevantes y mejorar la experiencia. ¬øAceptas cargar anuncios?</div>
    <div>
      <button id="acceptCookies">Aceptar</button>
      <button id="rejectCookies" style="background:#ccc;color:#000;margin-left:8px;">Rechazar</button>
    </div>
  </div>

  <script>
    // ========== Consentimiento de cookies y carga de Monetag ==========
    (function(){
      const banner = document.getElementById('cookieBanner');
      const consent = localStorage.getItem('cookie_consent'); // 'accepted' | 'rejected' | null
      if(!consent) banner.style.display = 'flex';
      else if(consent === 'accepted') loadMonetag();

      document.getElementById('acceptCookies').addEventListener('click', function(){
        localStorage.setItem('cookie_consent','accepted');
        banner.style.display = 'none';
        loadMonetag();
      });
      document.getElementById('rejectCookies').addEventListener('click', function(){
        localStorage.setItem('cookie_consent','rejected');
        banner.style.display = 'none';
      });
    })();

    function loadMonetag(){
      if (window.__monetag_loaded) return;
      window.__monetag_loaded = true;
      try {
        var s = document.createElement('script');
        s.async = true;
        s.src = 'https://www.monetag.com/js/3be5e844567977a9ec817c345620663e.js';
        document.head.appendChild(s);
      } catch(e) { console.warn('Error cargando Monetag', e); }
    }

    // ========== Calculadora ==========
    document.getElementById('priceCalculator').addEventListener('submit', function(e){
      e.preventDefault();
      calculatePrice();
    });
    function calculatePrice(){
      const hourlyRate = parseFloat(document.getElementById('hourlyRate').value) || 0;
      const estimatedHours = parseFloat(document.getElementById('estimatedHours').value) || 0;
      const expenses = parseFloat(document.getElementById('expenses').value) || 0;
      const profitMargin = parseFloat(document.getElementById('profitMargin').value) || 0;
      const taxes = parseFloat(document.getElementById('taxes').value) || 0;
      const urgency = document.getElementById('urgency').value;

      const baseCost = hourlyRate * estimatedHours;
      const profitAmount = baseCost * (profitMargin / 100);
      let urgencyMultiplier = 1;
      if (urgency === 'urgent') urgencyMultiplier = 1.25;
      if (urgency === 'emergency') urgencyMultiplier = 1.5;
      const urgencyFee = baseCost * (urgencyMultiplier - 1);

      const subtotal = baseCost + expenses + profitAmount + urgencyFee;
      const taxAmount = subtotal * (taxes / 100);
      const finalPrice = subtotal + taxAmount;

      document.getElementById('baseCost').textContent = `$${baseCost.toFixed(2)}`;
      document.getElementById('projectExpenses').textContent = `$${expenses.toFixed(2)}`;
      document.getElementById('profitAmount').textContent = `$${profitAmount.toFixed(2)}`;
      document.getElementById('urgencyFee').textContent = `$${urgencyFee.toFixed(2)}`;
      document.getElementById('subtotal').textContent = `$${subtotal.toFixed(2)}`;
      document.getElementById('taxAmount').textContent = `$${taxAmount.toFixed(2)}`;
      document.getElementById('finalPrice').textContent = `$${finalPrice.toFixed(2)}`;

      document.getElementById('results').classList.add('show');
    }

    // ========== WhatsApp contact ==========
    function contactWhatsApp(){
      // wa.me requires international format without '+'
      const phone = '522491203394';
      const text = encodeURIComponent('Hola, estoy interesado en la versi√≥n premium de la Calculadora Pro Freelancer.');
      window.open(`https://wa.me/${phone}?text=${text}`, '_blank');
    }

    // ========== Chat assistant (simple) ==========
    function toggleChat(){
      const win = document.getElementById('chatWindow');
      win.classList.toggle('show');
      win.setAttribute('aria-hidden', win.classList.contains('show') ? 'false' : 'true');
    }
    function handleEnter(e){ if (e.key === 'Enter') { e.preventDefault(); sendMessage(); } }
    function sendMessage(){ const input = document.getElementById('chatInput'); const txt = input.value.trim(); if (!txt) return; addChatMessage('user', txt); input.value = ''; setTimeout(()=> addChatMessage('bot', getAutoReply(txt)), 600); }
    function addChatMessage(role, text){ const container = document.getElementById('chatMessages'); const div = document.createElement('div'); div.className = 'message ' + (role === 'bot' ? 'bot' : 'user'); div.textContent = text; container.appendChild(div); container.scrollTop = container.scrollHeight; }
    function getAutoReply(q){ q = (q || '').toLowerCase(); if (q.includes('tarifa') || q.includes('tarifa por hora')) { return 'Calcula tus costos fijos + horas facturables. Divide tus gastos mensuales entre horas facturables al mes, agrega margen deseado y listo.'; } if (q.includes('gastos')) { return 'Incluye software, licencias, infraestructura, subcontratos, viajes y un porcentaje para imprevistos.'; } if (q.includes('margen')) { return 'Un 20% es com√∫n; para proyectos de alto valor o riesgo sube al 30-50%.'; } if (q.includes('negociar')) { return 'Ofrece paquetes y comunica el valor; evita bajar precio sin opci√≥n de paquete reducido.'; } return 'Describe tu caso (horas estimadas, tarifa actual) y te doy una recomendaci√≥n pr√°ctica.'; }
  </script>
</body>
</html>
